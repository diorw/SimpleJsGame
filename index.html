<!doctype html>
<html lang="en" class="no-js" content-type : text/html ;charset="GBK">
<head>
<meta charset="gb2312">
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" type="text/css" href="css/reset.css">
<link rel="stylesheet"  type="text/css" href="css/style.css">
<script src="js/modernizr.js"></script>
<script language="javascript">
  //动态生成表格
	  var s;
    function buildBoard(size) {
		s=size;
      	var str = "<TABLE border=4 align='center' width=400 height=400>"
      	for (var x=0; x < size; x++) {
        	str+="<TR>"
        	for (var y=0; y < size; y++) {
				str+="<td id="+x+""+y+" onclick='td(this.id)'  style='background:white'>&nbsp;</TD>"
        	}
        	str+="</TR>"
      	}
      	str+="</TABLE>"
	  	return str;
    }


	//设置单元格变色
	function setTdColor(id,color){
		document.getElementById(id).style.background=color;
	}

	//返回单元格的颜色
	function returnColor(id){
		var tdColor=document.getElementById(id).style.background;
		return tdColor;

	}

	//判断点击的单元格是否是四边的单元格
	function idflag(id){
		var iid=parseInt(id);
		var shi=parseInt(iid/10);
		var ge=iid%10;

		if(shi==0||shi==b||ge==0||ge==b){
			return true;
		}
		else{
			return false;
		}
	}

	//根据点击单元格类型不同，使周围的单元格变色
	var b;
	function setColor(id,col){
		b=(s-1);
		//表格四个角的单元格
		if(id=="0"+b||id==b+"0"||id==b+""+b||id=="00"){
			document.getElementById(id).style.background=col;
			if(id=='00'){
				var ids=new Array(2);
				ids[0]='01';
				ids[1]='10';
				var c=new Array(2);
				c[0]=returnColor(ids[0]);
				c[1]=returnColor(ids[1]);
				setTdColor(ids[0],col);
				setTdColor(ids[1],col);
				for(var k=0;k<2;k++){
					if(c[k]=="red"){
						setTdColor(ids[k],'white');
					}else{
						setTdColor(ids[k],'red');
					}
				}
			}
			if(id==b+'0'){
				var ids=new Array(2);
				ids[0]=(b-1)+'0';
				ids[1]=b+'1';
				var c=new Array(2);
				c[0]=returnColor(ids[0]);
				c[1]=returnColor(ids[1]);
				setTdColor(ids[0],col);
				setTdColor(ids[1],col);
				for(var k=0;k<2;k++){
					if(c[k]=="red"){
						setTdColor(ids[k],'white');
					}else{
						setTdColor(ids[k],'red');
					}
				}
			}
			if(id=='0'+b){
				var ids=new Array(2);
				ids[0]='0'+(b-1);
				ids[1]='1'+b;
				var c=new Array(2);
				c[0]=returnColor(ids[0]);
				c[1]=returnColor(ids[1]);
				setTdColor(ids[0],col);
				setTdColor(ids[1],col);
				for(var k=0;k<2;k++){
					if(c[k]=="red"){
						setTdColor(ids[k],'white');
					}else{
						setTdColor(ids[k],'red');
					}
				}
			}
			if(id==b+''+b){
				var ids=new Array(2);
				ids[0]=(b-1)+''+b;
				ids[1]=b+''+(b-1);
				var c=new Array(2);
				c[0]=returnColor(ids[0]);
				c[1]=returnColor(ids[1]);
				setTdColor(ids[0],col);
				setTdColor(ids[1],col);
				for(var k=0;k<2;k++){
					if(c[k]=="red"){
						setTdColor(ids[k],'white');
					}else{
						setTdColor(ids[k],'red');
					}
				}
			}
		}


		//四边的单元格
		else if(idflag(id)){
				for(var j=0;j<s;j++){
					if(id=='0'+j){
						var ids=new Array(3);
						ids[0]='0'+(j-1);
						ids[1]='0'+(j+1);
						ids[2]='1'+j;
						var c=new Array(3);
						c[0]=returnColor(ids[0]);
						c[1]=returnColor(ids[1]);
						c[2]=returnColor(ids[2]);
						setTdColor(id,col);
						setTdColor(ids[0],col);
						setTdColor(ids[1],col);
						setTdColor(ids[2],col);
						for(var k=0;k<3;k++){
							if(c[k]=="red"){
								setTdColor(ids[k],'white');
							}else{
								setTdColor(ids[k],'red');
							}
						}
					}
					if(id==b+''+j){
						var ids=new Array(3);
						ids[0]=b+''+(j-1);
						ids[1]=b+''+(j+1);
						ids[2]=(b-1)+''+j;
						var c=new Array(3);
						c[0]=returnColor(ids[0]);
						c[1]=returnColor(ids[1]);
						c[2]=returnColor(ids[2]);
						setTdColor(id,col);
						setTdColor(ids[0],col);
						setTdColor(ids[1],col);
						setTdColor(ids[2],col);
						for(var k=0;k<3;k++){
							if(c[k]=="red"){
								setTdColor(ids[k],'white');
							}else{
								setTdColor(ids[k],'red');
							}
						}
					}
					if(id==j+'0'){
						var ids=new Array(3);
						ids[0]=(j-1)+'0';
						ids[1]=(j+1)+'0';
						ids[2]=j+'1';
						var c=new Array(3);
						c[0]=returnColor(ids[0]);
						c[1]=returnColor(ids[1]);
						c[2]=returnColor(ids[2]);
						setTdColor(id,col);
						setTdColor(ids[0],col);
						setTdColor(ids[1],col);
						setTdColor(ids[2],col);
						for(var k=0;k<3;k++){
							if(c[k]=="red"){
								setTdColor(ids[k],'white');
							}else{
								setTdColor(ids[k],'red');
							}
						}
					}
					if(id==j+''+b){

						var ids=new Array(3);
						ids[0]=(j-1)+''+b;
						ids[1]=(j+1)+''+b;
						ids[2]=j+''+(b-1);
						var c=new Array(3);
						c[0]=returnColor(ids[0]);
						c[1]=returnColor(ids[1]);
						c[2]=returnColor(ids[2]);
						setTdColor(id,col);
						setTdColor(ids[0],col);
						setTdColor(ids[1],col);
						setTdColor(ids[2],col);
						for(var k=0;k<3;k++){
							if(c[k]=="red"){
								setTdColor(ids[k],'white');
							}else{
								setTdColor(ids[k],'red');
							}
						}
				}
			}
		}


		//中间的单元格
		else{
			for(var i=1;i<b;i++){
				for(var j=1;j<b;j++){
					if(id==i+""+j){
						var id1=new Array(4);
						id1[0]=(i+1)+""+j;
						id1[1]=(i-1)+""+j;
						id1[2]=i+""+(j+1);
						id1[3]=i+""+(j-1);
						var c=new Array(4);
						c[0]=returnColor(id1[0]);
						c[1]=returnColor(id1[1]);
						c[2]=returnColor(id1[2]);
						c[3]=returnColor(id1[3]);
						setTdColor(id,col);
						setTdColor(id1[0],col);
						setTdColor(id1[1],col);
						setTdColor(id1[2],col);
						setTdColor(id1[3],col);
						for(var k=0;k<4;k++){
							if(c[k]=="red"){
								setTdColor(id1[k],'white');
							}else{
								setTdColor(id1[k],'red');
							}
						}

					}
				}

			}
		}
	}

	//点击单元格事件
	var sum;
	var lian;
	var bu;
	function td(id){
		var name= document.getElementById("name").value;
		var t=document.getElementById(id);
		if(t.style.background=="white"){
			setColor(id,'red');
		}
		else{
			setColor(id,'white');
		}

		//计算各种数据
		sum++;
		lian=0;
		bu=0;
		var value=parseInt(document.getElementById('size').value);
		for(var i=0;i<value;i++){
			for(var j=0;j<value;j++){
				var dd=document.getElementById(i+''+j).style.background;
				if(dd=='red'){
					lian++;
				}else{
					bu++;
				}
			}
		}
		if(lian==count){
			document.getElementById('tb').innerHTML="<font size=7 color='red'>成功</font>"

			console.log("ok");
			save();
		}
		document.getElementById('sum').innerHTML=sum;
		document.getElementById('lian').innerHTML=lian;
		document.getElementById('bu').innerHTML=bu;
	  document.getElementById('name').innerHTML=name;

	}
	var count;
	function init(){
		sum=0;
		var value=document.getElementById('size').value;
		var name = document.getElementById('name').value;
		count=parseInt(value)*parseInt(value);
		document.getElementById("count").innerHTML=count;
		document.getElementById("sum").innerHTML=0;
		document.getElementById("bu").innerHTML=count;
		document.getElementById("lian").innerHTML=0;
		document.getElementById("tb").innerHTML=buildBoard(value);
		document.getElementById("name").innerHTML=name;
	}
	var db = openDatabase('C:\\Users\\ACM\\test.db','','排行榜',204800);
	if(db){
		console.log("创建成功");
	}
	function save(){
		var row =   document.getElementById("size").value;
		var times =   document.getElementById("bu").value;
		var name =  document.getElementById("name").value;
		db.transaction(function(tx){
        tx.executeSql('select * from ranktable',[],function(tx,rs){
					console.log(rs.rows.length);
				});
    });
	}
	function onSuccess(tx,rs){
    alert("操作成功");

}
//sql语句执行失败后执行的回调函数
	function onError(tx,error){
    alert("操作失败，失败信息："+ error.message);
  }
</script>
<title>Ink Transition Effect | CodyHouse</title>
</head>

<body>
<main class="cd-main-content">
	<div class="center">
		<a href="#0" class="cd-btn cd-modal-trigger">点击试试</a><br><br><br>


	</div>
</main> <!-- .cd-main-content -->

<div class="cd-modal">
	<div class="modal-content">
	<table width="715" height="142" border="1" align="center" >




  <tr>
    <td height="50"><table width="709" height="46" border="1" bordercolor = "white">
      <tr>
        <td width="41">总数</td>
        <td width="48" id="count">&nbsp;</td>
        <td width="59">点亮数</td>
        <td width="52" id="lian">&nbsp;</td>
        <td width="71">未点亮数</td>
        <td width="45" id="bu">&nbsp;</td>
        <td width="59">点击数</td>
        <td width="46" id="sum">&nbsp;</td>
        <td width="219">大小
          <input name="size" type="text" id="size" size="5" />
          （3-10）
          <input type="button" name="button" id="button" value="开始" onclick="init()" /></td>
					<td width = "50" id = "inputname">姓名
						<input name = "name" type = "text" id = "name" size = "5"/>
					</td>
      </tr>
    </table></td>
  </tr>



  <tr>
    <td><div id="tb"></div></td>
  </tr>
  <tr>
    <td height="25">游戏提示：将所有方格都变成红色即可胜利</td>
  </tr>
</table>

	</div> <!-- .modal-content -->

	<a href="#0" class="modal-close">Close</a>
</div>
<!-- .cd-modal -->

<div class="cd-transition-layer">
	<div class="bg-layer"></div>
</div> <!-- .cd-transition-layer -->

<script src="js/jquery-2.1.4.js"></script>


<script src="js/main.js"></script> <!-- Resource jQuery -->
</body>
</html>
